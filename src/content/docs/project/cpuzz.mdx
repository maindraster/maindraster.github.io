---
title: CPU 制作入门
lastUpdated: 2025-02-26
---

import { Aside } from '@astrojs/starlight/components';

:::note[项目介绍]
原来这是一个课程（从非门到俄罗斯方块），但因其贯通性和实践性，也可以称其为一个项目。

完整的课程内容在[《From Nand to Tetris》](https://www.nand2tetris.org/)。

2025.2.26本项目修改为针对《CPU制作入门》，鉴于前面部分内容相通， 遂保留。
:::

## 第一章CPU制作的基础知识

### 1.1 电路能够描述逻辑的理由

:::tip[电与逻辑的邂逅]
最早发展起来的是模拟电子技术，因为自然界当中声音、图像等信息本质上是连续的。例如电报，直接对声音处理转化为电信号，再还原比较容易和方便。另外电力技术也不够先进，具有离散特性的硬件还没制造出来。

但是人类社会为了交流，必须要标准化、量化一些东西。绝大多数计算都是有限小数或整数计算。模拟电子技术可以实现加减乘除积分微分，但连续信号无法存储，以及受噪声影响大两个问题导致其无法完成复杂运算。机械、液压响应太慢，光学发展不成熟。

<Aside type="note" title="香农：小事一桩">
香农意识到[布尔逻辑运算](./1-1b)与电气开关的开闭状态之间存在一一对应关系。在1938年的硕士论文《继电器和开关电路的符号分析》中，香农提出一种系统化的方法，用布尔表达式设计开关电路。
</Aside>

那时已经有电子管这样有“离散/开关”特性的器件了，于是实现计算的大任就交到了“离散”的“电”的手里。1947年晶体管发明，才慢慢有了数字电路的说法。
:::

正片开始🎬

晶体管：输入（基极）的电位为1（高于特定点位），集电极和发射极就回到同。一般集电极接正极，发射极接负极，电流从集电极流向发射极。可以说晶体管是通过基极电位操作开关电路的。

![s550](../../../assets/images/cpu1-1.png)

现在可以用电路实现 `AND、OR、NOT`了，而在[布尔逻辑运算](./1-1b)我们也知道任何布尔函数都能用它们的运算表达式表示。举个例子，加法（半加器：一位加一位，含进位）。

```
S = (A OR B) AND NOT (A AND B)
C = A AND B
```

可见用一系列电路描述组合逻辑，可对任意输入给出输出给定结果。描述这种组合逻辑的电路被称为[组合逻辑电路](../../electronics/fpga/1)。

### 1.2 为何能用基本逻辑电路实现 CPU

只有组合逻辑电路仍然没有存储功能，于是有了时序逻辑。
- 时序逻辑：根据当前的输入值和输出值决定最终输出值

用AND,OR和NOT可以描述各种真值表，但是前两者制造需要花费的晶体管更多，因此采用NAND,NOR和NOT。虽然只用NAND也可以，但是有NOR可以简化电路，同样也是节约材料和空间。很多目前CPU的基本元件是CMOS电路（由MOSFET元件组成的电路），在结构上更容易描述NAND和NOR。

一些时序逻辑电路查看[FPGA-1](../electronics/fpga/1#16-触发器和锁存器)。

组合逻辑电路和时序逻辑电路组合起来的电路被称为**有限状态机**（有限自动机），是 CPU 的基本形态。两个优点：
- 增加支持的运算种类
- 减小电路尺寸

:::note[二次加法]
1. 输入
2. 加法（组合逻辑）
3. 记忆加法结果（时序逻辑）
4. 加法（组合逻辑）
5. 输出
:::


### 1.3 CPU 的制造流程